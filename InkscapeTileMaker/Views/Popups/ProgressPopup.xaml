<?xml version="1.0" encoding="utf-8" ?>
<toolkit:Popup xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
               xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
               xmlns:vms="clr-namespace:InkscapeTileMaker.ViewModels.Popups"
               xmlns:toolkit="http://schemas.microsoft.com/dotnet/2022/maui/toolkit"
               x:Class="InkscapeTileMaker.Views.Popups.ProgressPopup"
               x:DataType="vms:ProgressPopupViewModel"
               MinimumWidthRequest="200"
               MinimumHeightRequest="120"
               CanBeDismissedByTappingOutsideOfPopup="False">

    <ContentView.Resources>
        <toolkit:InvertedBoolConverter x:Key="InverseBoolConverter"/>
    </ContentView.Resources>

    <Grid BackgroundColor="{DynamicResource OffBlack}"
          Padding="16"
          RowDefinitions="Auto,Auto"
          ColumnDefinitions="*">

        <Label Grid.Row="0"
               Text="{Binding Message}"
               FontSize="14"
               TextColor="{DynamicResource LightGray}"
               HorizontalOptions="Center"
               HorizontalTextAlignment="Center"
               LineBreakMode="WordWrap"
               Margin="0,0,0,12" />

        <Grid Grid.Row="1"
              RowDefinitions="*"
              ColumnDefinitions="*">

            <ProgressBar Grid.Row="0"
                         Progress="{Binding Progress}"
                         IsVisible="{Binding IsIndeterminate, Converter={StaticResource InverseBoolConverter}}"
                         VerticalOptions="Center"
                         ProgressColor="{DynamicResource Primary}"
                         BackgroundColor="{DynamicResource Gray600}"/>

            <ActivityIndicator Grid.Row="0"
                               IsRunning="{Binding IsIndeterminate}"
                               IsVisible="{Binding IsIndeterminate}"
                               Color="{DynamicResource Primary}"
                               HorizontalOptions="Center"
                               VerticalOptions="Center" />
        </Grid>
    </Grid>
</toolkit:Popup>
